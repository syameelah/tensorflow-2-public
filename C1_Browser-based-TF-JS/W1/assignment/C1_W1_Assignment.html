const trainingUrl = '/data/wdbc-train.csv';
const testingUrl = '/data/wdbc-test.csv';

const trainingData = tf.data.csv(trainingUrl, {
    columnNames: ['id', 'diagnosis', 'radius', 'texture', 'perimeter', 'area', 'smoothness', 'compactness', 'concavity', 'concave points', 'symmetry', 'fractal dimension']
});

const testingData = tf.data.csv(testingUrl, {
    columnNames: ['id', 'diagnosis', 'radius', 'texture', 'perimeter', 'area', 'smoothness', 'compactness', 'concavity', 'concave points', 'symmetry', 'fractal dimension']
});
const convertedTrainingData = trainingData.map(record => {
    const diagnosis = record.diagnosis === 'M' ? 1 : 0;
    return { x: Object.values(record).slice(1), y: diagnosis };
});

const convertedTestingData = testingData.map(record => {
    const diagnosis = record.diagnosis === 'M' ? 1 : 0;
    return { x: Object.values(record).slice(1), y: diagnosis };
});
const numOfFeatures = 30;
const model = tf.sequential();
model.add(tf.layers.dense({units: 32, activation: 'relu', inputShape: [numOfFeatures]}));
model.add(tf.layers.dense({units: 16, activation: 'relu'}));
model.add(tf.layers.dense({units: 1, activation: 'sigmoid'}));

model.compile({
    optimizer: tf.train.rmsprop(),
    loss: 'binaryCrossentropy',
    metrics: ['accuracy']
});
await model.fitDataset(convertedTrainingData, {
    epochs: 100,
    validationData: convertedTestingData,
    callbacks: {
        onEpochEnd: async(epoch, logs) => {
            console.log("Epoch: " + epoch + " Loss: " + logs.loss + " Accuracy: " + logs.acc);
        }
    }
});

await model.save('downloads://my_model');
<html>
<head></head>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@latest"></script>
    <script lang="js">
        
        async function run(){
            const trainingUrl = '/data/wdbc-train.csv';
            
            const trainingData = tf.data.csv(trainingUrl, {
                columnNames: ['id', 'diagnosis', 'radius', 'texture', 'perimeter', 'area', 'smoothness', 'compactness', 'concavity', 'concave points', 'symmetry', 'fractal dimension']
            });

            const testingUrl = '/data/wdbc-test.csv';

            const testingData = tf.data.csv(testingUrl, {
                columnNames: ['id', 'diagnosis', 'radius', 'texture', 'perimeter', 'area', 'smoothness', 'compactness', 'concavity', 'concave points', 'symmetry', 'fractal dimension']
            });

            const convertedTrainingData = trainingData.map(record => {
                const diagnosis
